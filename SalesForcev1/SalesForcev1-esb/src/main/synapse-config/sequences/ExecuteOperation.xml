<?xml version="1.0" encoding="UTF-8"?>
<sequence name="ExecuteOperation" trace="disable" xmlns="http://ws.apache.org/ns/synapse">
    <switch source="$ctx:YLO_URI">
        <case regex="/services/ContactManagementProxyv1/contacts/.*">
            <call-template description="get QueryInput as JSON" target="conf:syn/sharedResources/sequences/QueryInputAsJSON.xml">
                <with-param name="uri_template_value" value="/services/ContactManagementProxyv1/contacts/{contactId}"/>
            </call-template>
            <log category="DEBUG" description="query input" level="custom" separator=",">
                <property name="status" value="query input:"/>
                <property expression="$ctx:YLO_URI_PARAMS" name="URL Params"/>
            </log>
            <property description="technicalId" expression="get-property('MessageID')" name="technicalId" scope="default" type="STRING"/>
            <property description="businessCase" name="businessCase" scope="default" type="STRING" value="ContactManagementProxyv1"/>
            <property description="businessId" expression="//contactId" name="businessId" scope="default" type="STRING"/>
            <log category="DEBUG" description="Request" level="custom">
                <property name="status" value="GetContactById Request input"/>
                <property expression="//contactId" name="contactId"/>
                <property expression="$ctx:technicalId" name="technicalId"/>
                <property expression="$ctx:businessCase" name="businessCase"/>
                <property expression="$ctx:businessId" name="businessId"/>
            </log>
            <sequence key="ObtainSalesforceAccessToken"/>
            <sequence key="GetSalesforceContact"/>
        </case>
        <default>
            <log description="ERROR" separator=",">
                <property name="ERROR" value="Invalid input URI Template"/>
                <property expression="$ctx:YLO_URI" name="uri_template_value"/>
                <property expression="$ctx:technicalId" name="technicalId"/>
                <property expression="$ctx:businessCase" name="businessCase"/>
                <property expression="$ctx:businessId" name="businessId"/>
            </log>
        </default>
    </switch>
</sequence>
